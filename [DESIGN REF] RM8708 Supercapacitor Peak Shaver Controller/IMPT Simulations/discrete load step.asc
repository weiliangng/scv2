Version 4
SHEET 1 2380 1844
WIRE -1552 -336 -1680 -336
WIRE -1216 -336 -1552 -336
WIRE -832 -336 -1216 -336
WIRE -720 -336 -832 -336
WIRE -560 -336 -720 -336
WIRE -480 -336 -560 -336
WIRE -336 -336 -480 -336
WIRE -304 -336 -336 -336
WIRE -240 -336 -304 -336
WIRE -208 -336 -240 -336
WIRE -112 -336 -128 -336
WIRE -32 -336 -112 -336
WIRE 0 -336 -32 -336
WIRE 16 -336 0 -336
WIRE 352 -336 112 -336
WIRE 400 -336 352 -336
WIRE 496 -336 400 -336
WIRE 624 -336 496 -336
WIRE 848 -336 704 -336
WIRE 928 -336 848 -336
WIRE 992 -336 928 -336
WIRE 1232 -336 992 -336
WIRE 1376 -336 1328 -336
WIRE 1440 -336 1376 -336
WIRE 1472 -336 1440 -336
WIRE 1584 -336 1552 -336
WIRE 1616 -336 1584 -336
WIRE 1712 -336 1616 -336
WIRE 1792 -336 1712 -336
WIRE 2080 -336 1792 -336
WIRE -832 -320 -832 -336
WIRE -720 -320 -720 -336
WIRE 1792 -320 1792 -336
WIRE 2080 -320 2080 -336
WIRE -1216 -304 -1216 -336
WIRE -304 -304 -304 -336
WIRE 496 -304 496 -336
WIRE 848 -304 848 -336
WIRE 1376 -304 1376 -336
WIRE 1616 -304 1616 -336
WIRE -32 -288 -32 -336
WIRE 2080 -256 1920 -256
WIRE -832 -240 -832 -256
WIRE -720 -240 -832 -240
WIRE -560 -240 -560 -256
WIRE 1920 -240 1920 -256
WIRE 1920 -240 1792 -240
WIRE -720 -224 -720 -240
WIRE -560 -224 -560 -240
WIRE 448 -224 432 -224
WIRE 912 -224 896 -224
WIRE 1792 -224 1792 -240
WIRE 1376 -208 1376 -240
WIRE -32 -192 -32 -224
WIRE 496 -192 496 -208
WIRE 672 -192 496 -192
WIRE 704 -192 672 -192
WIRE 848 -192 848 -208
WIRE 848 -192 704 -192
WIRE 672 -176 672 -192
WIRE 672 -176 560 -176
WIRE -240 -160 -240 -336
WIRE -112 -160 -112 -336
WIRE 672 -160 672 -176
WIRE 912 -144 912 -224
WIRE 432 -128 432 -224
WIRE 0 -112 0 -336
WIRE 0 -112 -16 -112
WIRE 560 -64 560 -176
WIRE 672 -64 672 -80
WIRE 768 -64 672 -64
WIRE 96 -48 96 -288
WIRE 672 -48 672 -64
WIRE 768 -48 768 -64
WIRE 1248 -48 1248 -288
WIRE 1440 -48 1440 -336
WIRE -240 -16 -240 -80
WIRE -240 -16 -288 -16
WIRE -208 -16 -240 -16
WIRE -112 -16 -112 -80
WIRE -112 -16 -144 -16
WIRE -80 -16 -112 -16
WIRE -288 0 -288 -16
WIRE -80 0 -80 -16
WIRE -208 48 -208 -16
WIRE -144 48 -144 -16
WIRE 560 48 560 16
WIRE 592 48 560 48
WIRE 672 48 656 48
WIRE 688 48 672 48
WIRE 768 48 768 32
WIRE 768 48 752 48
WIRE 672 64 672 48
WIRE 1248 80 1248 32
WIRE 464 112 224 112
WIRE 1328 112 528 112
WIRE 96 144 96 32
WIRE 224 176 224 112
WIRE 256 176 224 176
WIRE 352 176 352 -336
WIRE 352 176 320 176
WIRE 432 176 432 -48
WIRE 464 176 432 176
WIRE 480 176 464 176
WIRE 880 176 864 176
WIRE 912 176 912 -64
WIRE 912 176 880 176
WIRE 992 176 992 -336
WIRE 1024 176 992 176
WIRE 1120 176 1088 176
WIRE 1152 176 1120 176
WIRE 1296 176 1216 176
WIRE 1328 176 1328 112
WIRE 1328 176 1296 176
WIRE 560 192 560 48
WIRE 592 192 560 192
WIRE 608 192 592 192
WIRE 640 192 608 192
WIRE 736 192 704 192
WIRE 752 192 736 192
WIRE 768 192 768 48
WIRE 768 192 752 192
WIRE 96 224 96 144
WIRE 224 224 224 176
WIRE 352 224 352 176
WIRE 480 224 480 176
WIRE 608 224 608 192
WIRE 736 224 736 192
WIRE 864 224 864 176
WIRE 992 224 992 176
WIRE 1120 224 1120 176
WIRE 1248 224 1248 80
WIRE -16 288 -16 -112
WIRE 48 288 -16 288
WIRE 1376 288 1296 288
WIRE 1440 288 1440 32
WIRE 1440 288 1376 288
WIRE 1712 336 1712 -336
WIRE -16 352 -16 288
WIRE 48 352 -16 352
WIRE 1440 352 1296 352
WIRE 1584 352 1584 -336
WIRE 1584 352 1440 352
WIRE -480 368 -480 -336
WIRE -336 416 -336 -336
WIRE 48 416 -336 416
WIRE -480 480 -480 448
WIRE 48 480 -480 480
WIRE 1376 480 1296 480
WIRE 1712 480 1712 416
WIRE 1712 480 1376 480
WIRE 1712 512 1712 480
WIRE -480 528 -480 480
WIRE -240 544 -304 544
WIRE -16 544 -160 544
WIRE 48 544 -16 544
WIRE 1328 544 1328 176
WIRE 1328 544 1296 544
WIRE 1344 544 1328 544
WIRE 1424 544 1408 544
WIRE -176 608 -192 608
WIRE -16 608 -112 608
WIRE 48 608 -16 608
WIRE 1328 608 1328 544
WIRE 1328 608 1296 608
WIRE -480 624 -480 608
WIRE 1712 624 1712 592
WIRE -1552 640 -1552 -336
WIRE -1552 640 -2160 640
WIRE 48 672 -64 672
WIRE 1376 672 1296 672
WIRE 1840 672 1376 672
WIRE -176 736 -304 736
WIRE 48 736 -176 736
WIRE 1376 736 1296 736
WIRE 1680 736 1376 736
WIRE -768 784 -864 784
WIRE -752 784 -768 784
WIRE -512 784 -672 784
WIRE -304 784 -304 736
WIRE -304 784 -512 784
WIRE -64 800 -96 800
WIRE 48 800 16 800
WIRE 1376 800 1296 800
WIRE 1408 800 1376 800
WIRE 1488 800 1472 800
WIRE -672 832 -672 784
WIRE -624 832 -672 832
WIRE -2160 848 -2160 640
WIRE -2064 848 -2160 848
WIRE -1952 848 -1984 848
WIRE -1888 848 -1952 848
WIRE -1712 848 -1888 848
WIRE -1680 848 -1712 848
WIRE -1952 864 -1952 848
WIRE -16 864 -64 864
WIRE 48 864 -16 864
WIRE 1616 864 1296 864
WIRE -64 880 -64 864
WIRE -864 912 -864 864
WIRE 48 928 16 928
WIRE 1344 928 1296 928
WIRE -2160 944 -2160 928
WIRE -2064 944 -2160 944
WIRE -1952 944 -1952 928
WIRE -1952 944 -1984 944
WIRE -1920 944 -1952 944
WIRE -1440 960 -1520 960
WIRE -1328 960 -1360 960
WIRE -1248 960 -1328 960
WIRE 1344 960 1344 928
WIRE 1360 960 1344 960
WIRE -64 976 -64 944
WIRE -768 992 -768 784
WIRE -1920 1008 -1920 944
WIRE -1888 1008 -1920 1008
WIRE -1712 1008 -1888 1008
WIRE -1680 1008 -1712 1008
WIRE 448 1008 448 992
WIRE 880 1008 880 992
WIRE 1168 1008 1168 992
WIRE 1200 1008 1168 1008
WIRE 592 1024 592 992
WIRE 1024 1024 1024 992
WIRE 1168 1024 1168 1008
WIRE 1344 1024 1344 960
WIRE 1680 1024 1680 736
WIRE 1840 1024 1840 672
WIRE 160 1056 160 992
WIRE -2160 1088 -2160 944
WIRE -2032 1088 -2160 1088
WIRE -2160 1120 -2160 1088
WIRE 592 1120 592 1104
WIRE 1168 1120 1168 1088
WIRE 1344 1120 1344 1088
WIRE 1680 1120 1680 1088
WIRE 1840 1120 1840 1088
WIRE -2208 1184 -2336 1184
WIRE -2160 1216 -2160 1200
WIRE -2096 1584 -2256 1584
WIRE -2096 1680 -2096 1664
FLAG -480 624 0
FLAG -192 608 0
FLAG -96 800 0
FLAG -64 976 0
FLAG 1488 800 0
FLAG 448 1008 0
FLAG 672 -48 0
FLAG 1792 -336 OUT
FLAG 1792 -224 0
FLAG 1712 624 0
FLAG 672 64 0
FLAG 880 1008 0
FLAG 16 928 0
FLAG -720 -224 0
FLAG 1424 544 0
FLAG -32 -192 0
FLAG 1376 -208 0
FLAG 1840 1120 0
FLAG 1680 1120 0
FLAG 1344 1120 0
FLAG 1168 1120 0
FLAG -720 -336 IN
FLAG -208 48 CSINP
FLAG -144 48 CSINN
FLAG -864 912 0
FLAG -672 912 0
FLAG -624 896 0
FLAG -16 608 LDO33
FLAG 592 1120 LDO33
FLAG 160 1056 LDO33
FLAG -304 544 LDO33
FLAG -512 784 FBIN
FLAG -16 544 SWEN
FLAG 400 -336 SW1
FLAG 928 -336 SW2
FLAG 592 192 CSP
FLAG 752 192 CSN
FLAG 464 176 BG1
FLAG 880 176 BG2
FLAG 1296 176 INTVCC
FLAG 1120 176 BOOST2
FLAG 224 112 BOOST1
FLAG 96 144 TG1
FLAG 1248 80 TG2
FLAG -16 864 SS
FLAG 704 -192 Sources
FLAG 1376 288 CSPOUT
FLAG 1376 480 FBOUT
FLAG 1376 672 ICP
FLAG 1376 736 ICN
FLAG 1376 800 VC
FLAG 1360 960 IMON_OP
FLAG 1200 1008 IMON_ON
FLAG -64 672 0
FLAG -2112 1824 0
FLAG -560 -144 0
FLAG -560 -240 vfbin
FLAG 1024 1024 vfbin
FLAG 1616 864 0
FLAG 1616 -240 0
FLAG -304 -240 0
FLAG -2160 1216 0
FLAG -2208 1136 0
FLAG -2336 1264 0
FLAG -1520 1040 0
FLAG -1712 848 CSS3P
FLAG -1712 1008 CSS3N
FLAG -1328 1024 0
FLAG -176 800 0
FLAG -288 64 0
FLAG -80 64 0
FLAG -1888 1072 0
FLAG -1888 784 0
FLAG -1248 960 set
FLAG -2096 1680 0
FLAG -2256 1664 0
FLAG -768 1136 0
FLAG -1216 -240 0
FLAG -2032 1152 0
SYMBOL res 80 -64 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL res 896 -160 R0
SYMATTR InstName R2
SYMATTR Value 1
SYMBOL res 1232 -64 R0
SYMATTR InstName R3
SYMATTR Value 1
SYMBOL res 656 -176 R0
SYMATTR InstName R4
SYMATTR Value 2.5m
SYMBOL res 544 -80 R0
SYMATTR InstName R5
SYMATTR Value 10
SYMBOL res 752 -64 R0
SYMATTR InstName R6
SYMATTR Value 10
SYMBOL cap 656 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL cap 752 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL cap 320 160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 0.22µ
SYMBOL cap 1088 160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 0.22µ
SYMBOL cap -112 592 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 4.7µ
SYMBOL res 32 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 294K
SYMBOL cap 1408 816 R270
WINDOW 3 0 32 VBottom 2
WINDOW 123 -36 32 VBottom 2
WINDOW 39 -18 32 VBottom 2
WINDOW 0 32 32 VTop 2
SYMATTR Value 6.8n
SYMATTR SpiceLine Rser=15k Cpar=220p
SYMATTR InstName C6
SYMBOL cap -80 880 R0
SYMATTR InstName C7
SYMATTR Value 47n
SYMBOL ind 608 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 6.8µ
SYMATTR SpiceLine Rser=.47m Rpar=1K
SYMBOL diode 528 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value MURS120
SYMBOL diode 1216 160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value MURS120
SYMBOL res 1424 -64 R0
SYMATTR InstName R8
SYMATTR Value 10
SYMBOL res 1456 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value 2.5m
SYMBOL res 1696 496 R0
SYMATTR InstName R10
SYMATTR Value 7.68k
SYMBOL voltage -720 -336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0.1
SYMATTR InstName Bus1
SYMATTR Value 24
SYMBOL res 576 1008 R0
SYMATTR InstName R11
SYMATTR Value 100K
SYMBOL voltage 1792 -336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0.1
SYMATTR InstName Cap1
SYMATTR Value 24
SYMBOL nmos 16 -288 R270
WINDOW 0 56 53 VTop 2
WINDOW 3 31 91 VRight 2
SYMATTR InstName Q1
SYMATTR Value BSC016N04LS
SYMBOL nmos 448 -304 R0
WINDOW 3 56 62 Left 2
SYMATTR Value BSC016N04LS
SYMATTR InstName Q2
SYMBOL nmos 1328 -288 M270
WINDOW 0 79 39 VTop 2
WINDOW 3 51 37 VTop 2
SYMATTR InstName Q3
SYMATTR Value BSC016N04LS
SYMBOL nmos 896 -304 M0
WINDOW 0 -33 26 Left 2
WINDOW 3 -157 58 Left 2
SYMATTR InstName Q4
SYMATTR Value BSC016N04LS
SYMBOL res -112 -352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 2m
SYMBOL res 416 -144 R0
SYMATTR InstName R13
SYMATTR Value 1
SYMBOL res -496 352 R0
SYMATTR InstName R14
SYMATTR Value 665K
SYMBOL res 1696 320 R0
SYMATTR InstName R15
SYMATTR Value 162k
SYMBOL cap 1424 352 M180
WINDOW 0 28 50 Left 2
WINDOW 3 37 30 Left 2
SYMATTR InstName C8
SYMATTR Value 470n
SYMBOL cap 1408 528 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value 4.7µ
SYMBOL cap -48 -288 R0
SYMATTR InstName C11
SYMATTR Value 9µ
SYMATTR SpiceLine Rser=4m
SYMBOL cap 1360 -304 R0
SYMATTR InstName C12
SYMATTR Value 9µ
SYMATTR SpiceLine Rser=4m
SYMBOL cap 1824 1024 R0
WINDOW 3 40 35 Left 2
WINDOW 123 27 59 Left 2
SYMATTR Value 4.7n
SYMATTR Value2 Rpar=17.4K
SYMATTR InstName C13
SYMBOL cap 1664 1024 R0
WINDOW 3 40 35 Left 2
WINDOW 123 23 58 Left 2
SYMATTR Value 4.7n
SYMATTR Value2 Rpar=17.4K
SYMATTR InstName C14
SYMBOL res -144 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 100K
SYMBOL LT8708 672 608 R0
SYMATTR InstName U1
SYMBOL cap -848 -320 R0
SYMATTR InstName C17
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=20m
SYMBOL cap 2064 -320 R0
SYMATTR InstName C18
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=20m
SYMBOL res -496 512 R0
SYMATTR InstName R17
SYMATTR Value 100k
SYMBOL res -656 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 365
SYMBOL res -656 928 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value 976
SYMBOL cap -640 832 R0
SYMATTR InstName C19
SYMATTR Value 1µ
SYMBOL cap 704 176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C20
SYMATTR Value 3.3n
SYMBOL bv -864 768 R0
WINDOW 3 -87 174 Left 2
SYMATTR Value V=limit((V(CSINN,CSINP)*50+V(set)),0,3.3)
SYMATTR InstName B1
SYMBOL voltage -2112 1728 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PWL(0 1.65 5m 1.65 5.1m 0.65 10m 0.65 10.1m 2.65 15m 2.65 30m 0.65 45m 2.65)
SYMBOL res -576 -352 R0
SYMATTR InstName R20
SYMATTR Value 191k
SYMBOL res -576 -240 R0
SYMATTR InstName R21
SYMATTR Value 7.68k
SYMBOL cap -320 -304 R0
SYMATTR InstName C21
SYMATTR Value 9µ
SYMATTR SpiceLine Rser=4m
SYMBOL cap 1600 -304 R0
SYMATTR InstName C22
SYMATTR Value 9µ
SYMATTR SpiceLine Rser=4m
SYMBOL res -2144 944 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R22
SYMATTR Value 2m
SYMBOL sw -2160 1104 R0
SYMATTR InstName Load1
SYMATTR Value SW3
SYMBOL voltage -2336 1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 5 5m 0.1m 0.1m 2m 4m)
SYMBOL bv -1520 944 R0
WINDOW 3 -87 174 Left 2
SYMATTR Value V=limit((V(CSS3N,CSS3P)*50+2.65),0,3.3)
SYMATTR InstName B2
SYMBOL res -256 -176 R0
SYMATTR InstName R23
SYMATTR Value 10
SYMBOL res -128 -176 R0
SYMATTR InstName R24
SYMATTR Value 10
SYMBOL cap -144 -32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C23
SYMATTR Value 470n
SYMBOL res -1344 944 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 100
SYMBOL cap -1344 960 R0
SYMATTR InstName C24
SYMATTR Value 47n
SYMBOL cap -192 736 R0
SYMATTR InstName C26
SYMATTR Value 47n
SYMBOL cap -304 0 R0
SYMATTR InstName C27
SYMATTR Value 22n
SYMBOL cap -96 0 R0
SYMATTR InstName C28
SYMATTR Value 22n
SYMBOL cap -1968 864 R0
SYMATTR InstName C29
SYMATTR Value 470n
SYMBOL res -1968 832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 10
SYMBOL res -1968 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 10
SYMBOL cap -1904 784 R0
SYMATTR InstName C30
SYMATTR Value 22n
SYMBOL cap -1904 1008 R0
SYMATTR InstName C31
SYMATTR Value 22n
SYMBOL cap 1152 1024 R0
SYMATTR InstName C9
SYMATTR Value 10n
SYMATTR SpiceLine Rpar=21k
SYMBOL cap 1328 1024 R0
SYMATTR InstName C15
SYMATTR Value 10n
SYMATTR SpiceLine Rpar=21k
SYMBOL bi -2096 1584 R0
SYMATTR InstName B3
SYMATTR Value I = {(9 + 9 * sin(2 * pi * (time - 0.006) * (20 + 980 * (time - 0.006) / 0.05))) * (1 / (1 + exp(-4000 * (time - 0.006))))}
SYMBOL voltage -2256 1568 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 24
SYMBOL res -784 976 R0
SYMATTR InstName R28
SYMATTR Value 365
SYMBOL cap -784 1072 R0
SYMATTR InstName C16
SYMATTR Value 47n
SYMBOL cap -1232 -304 R0
SYMATTR InstName C25
SYMATTR Value 3300µ
SYMATTR SpiceLine Rser=100m
SYMBOL cap -2048 1088 R0
SYMATTR InstName C32
SYMATTR Value 100n
SYMATTR SpiceLine Rser=100m
TEXT 1336 1256 Left 2 !.tran 60m\n.ic V(OUT)=24\n.ic V(IN)=24\n.model SW3 SW(Ron=1.33 Roff=25 Vt=2.5 Vh=0.1)
TEXT 640 -408 Center 3 ;24V Bidirectional Power Buffer System with FHCM and RHCM
TEXT 2216 -296 Left 2 ;supercap side
TEXT -1040 -320 Left 2 ;power bus
TEXT -2672 440 Left 2 ;Simulating transient response between load impedance of 2 ohms (10A+) and 27 ohm (1A)\ngreen is apparent battery current\nblue is load (motor) current
TEXT -1232 -168 Left 2 ;NOTE
